{"remainingRequest":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/john/Documents/Projects/Хакатоны/mvd/frontend/src/views/Main/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/src/views/Main/Home.vue","mtime":1620583586729},{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBNYXAgZnJvbSAiQC9jb21wb25lbnRzL21hcC9NYXAudnVlIjsKaW1wb3J0IENoYXJ0IGZyb20gIkAvY29tcG9uZW50cy9DaGFydC52dWUiOwppbXBvcnQgQ2x1c3Rlck1hcCBmcm9tICJAL2NvbXBvbmVudHMvbWFwL0NsdXN0ZXJNYXAudnVlIjsKaW1wb3J0IE1hcEZpbHRlciBmcm9tICJAL2NvbXBvbmVudHMvbWFwL01hcEZpbHRlci52dWUiOwppbXBvcnQgRGF0YVRhYmxlIGZyb20gIkAvY29tcG9uZW50cy9tYXAvRGF0YVRhYmxlLnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkhvbWUiLAogIGNvbXBvbmVudHM6IHsKICAgIE1hcCwKICAgIENsdXN0ZXJNYXAsCiAgICBNYXBGaWx0ZXIsCiAgICBEYXRhVGFibGUsCiAgICBDaGFydCwKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGVkOiBmYWxzZSwKCiAgICAgIGZpbHRlckRhdGE6IHt9LAogICAgICBjbHVzdGVyRGF0YTogW10sCiAgICAgIGNoYXJ0RGF0YToge30sCgogICAgICB0YWJsZUhlYWRlcnM6IFsKICAgICAgICB7IHRleHQ6ICLQktGA0LXQvNGPIiwgZmlsdGVyYWJsZTogdHJ1ZSwgYWxpZ246ICJzdGFydCIsIHZhbHVlOiAiZGF0ZXRpbWUiIH0sCiAgICAgICAgeyB0ZXh0OiAi0KDQtdCz0LjQvtC9IiwgZmlsdGVyYWJsZTogdHJ1ZSwgYWxpZ246ICJzdGFydCIsIHZhbHVlOiAicmVnaW9uIiB9LAogICAgICAgIHsgdGV4dDogItCQ0LTRgNC10YEiLCBmaWx0ZXJhYmxlOiB0cnVlLCBhbGlnbjogInN0YXJ0IiwgdmFsdWU6ICJhZGRyZXNzIiB9LAogICAgICAgIHsKICAgICAgICAgIHRleHQ6ICLQmtCw0YLQtdCz0L7RgNC40Y8iLAogICAgICAgICAgZmlsdGVyYWJsZTogdHJ1ZSwKICAgICAgICAgIGFsaWduOiAic3RhcnQiLAogICAgICAgICAgdmFsdWU6ICJjYXRlZ29yeSIsCiAgICAgICAgfSwKICAgICAgICB7IHRleHQ6ICLQntGB0LLQtdGJ0LXQvdC40LUiLCBmaWx0ZXJhYmxlOiB0cnVlLCBhbGlnbjogInN0YXJ0IiwgdmFsdWU6ICJsaWdodCIgfSwKICAgICAgXSwKICAgIH07CiAgfSwKCiAgbWV0aG9kczogewogICAgZG93bmxvYWQoZm9ybWF0KSB7CiAgICAgIGxldCB1cmwgPSBuZXcgVVJMKGAke3RoaXMuJHN0b3JlLnN0YXRlLmJhY2tlbmRVcmx9L2ZpbGUvY2x1c3Rlci8ke3RoaXMuZmlsdGVyRGF0YS5jbHVzdGVyX3F1b250aXR5fS8ke2Zvcm1hdH0vYCk7CiAgICAgIGlmICh0aGlzLmZpbHRlckRhdGEpIHsKICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpbHRlckRhdGEpLmZvckVhY2goKGtleSkgPT4gewogICAgICAgICAgaWYgKHRoaXMuZmlsdGVyRGF0YVtrZXldKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoa2V5LCB0aGlzLmZpbHRlckRhdGFba2V5XS50b0lTT1N0cmluZygpKTsKICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoa2V5LCB0aGlzLmZpbHRlckRhdGFba2V5XSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgICB3aW5kb3cub3Blbih1cmwuaHJlZik7CiAgICB9LAoKICAgIGdldERhdGEodmFsKSB7CiAgICAgIHRoaXMuZmlsdGVyRGF0YSA9IHZhbDsKCiAgICAgIGF4aW9zCiAgICAgICAgLmdldChgJHt0aGlzLiRzdG9yZS5zdGF0ZS5iYWNrZW5kVXJsfS9tYXAvcGxvdC1iYXIvYCwgewogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGNhdGVnb3J5OiB0aGlzLmZpbHRlckRhdGEuY2F0ZWdvcnksCiAgICAgICAgICAgIHJlZ2lvbjogdGhpcy5maWx0ZXJEYXRhLnJlZ2lvbiwKICAgICAgICAgICAgbGlnaHQ6IHRoaXMuZmlsdGVyRGF0YS5saWdodCwKICAgICAgICAgICAgZGF0ZXRpbWVfYmVmb3JlOiB0aGlzLmZpbHRlckRhdGEuZGF0ZXRpbWVfYmVmb3JlLAogICAgICAgICAgICBkYXRldGltZV9hZnRlcjogdGhpcy5maWx0ZXJEYXRhLmRhdGV0aW1lX2FmdGVyLAogICAgICAgICAgICB0aW1lX2dyb3VwOiB0aGlzLmZpbHRlckRhdGEudGltZV9ncm91cCwKICAgICAgICAgIH0sCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIHRoaXMuY2hhcnREYXRhID0gewogICAgICAgICAgICBsYWJlbHM6IHJlc3BvbnNlLmRhdGEubWFwKCh4KSA9PiB4Lm1vbnRoKSwKICAgICAgICAgICAgZGF0YXNldHM6IFsKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsYWJlbDogItCa0L7Qu9C40YfQtdGB0YLQstC+INC/0YDQtdGB0YLRg9C/0LvQtdC90LjQuSDQv9C+INC00LDRgtCw0LwiLAogICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICJFREFDNDgiLAogICAgICAgICAgICAgICAgcG9pbnRCYWNrZ3JvdW5kQ29sb3I6ICJibGFjayIsCiAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogMSwKICAgICAgICAgICAgICAgIHBvaW50Qm9yZGVyQ29sb3I6ICJ3aGl0ZSIsCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICIjRURBQzQ4IiwKICAgICAgICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLmRhdGEubWFwKCh4KSA9PiB4LmMpLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF0sCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgfSwKCiAgICBnZXRUYWJsZSh2YWwpIHsKICAgICAgdGhpcy5sb2FkZWQgPSBmYWxzZTsKICAgICAgdGhpcy5jbHVzdGVyRGF0YSA9IHZhbDsKICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/Main","sourcesContent":["<template>\n  <div>\n    <MapFilter\n      class=\"map-filter\"\n      :theme=\"{ color: '#55884F' }\"\n      @get-data=\"getData\"\n    />\n    <v-row class=\"maps-container mt-2 mb-6 px-3\">\n      <v-col cols=\"6\">\n        <Map class=\"map\" :filterParams=\"filterData\" />\n        <v-card\n          class=\"chart-card\"\n          elevation=\"0\"\n          style=\"border-radius: 15px\"\n          v-if=\"loaded\"\n        >\n          <Chart :chart-data=\"chartData\" />\n        </v-card>\n      </v-col>\n\n      <v-col cols=\"6\">\n        <ClusterMap\n          class=\"map\"\n          :filterParams=\"filterData\"\n          @get-table=\"getTable\"\n        />\n        <DataTable\n          :tableHeaders=\"tableHeaders\"\n          :tableItems=\"clusterData\"\n          v-if=\"loaded\"\n          v-on:download=\"download\"\n        />\n      </v-col>\n    </v-row>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import \"@/styles/common.scss\";\n@import \"@/styles/views/home.scss\";\n</style>\n\n<script>\nimport Map from \"@/components/map/Map.vue\";\nimport Chart from \"@/components/Chart.vue\";\nimport ClusterMap from \"@/components/map/ClusterMap.vue\";\nimport MapFilter from \"@/components/map/MapFilter.vue\";\nimport DataTable from \"@/components/map/DataTable.vue\";\n\nexport default {\n  name: \"Home\",\n  components: {\n    Map,\n    ClusterMap,\n    MapFilter,\n    DataTable,\n    Chart,\n  },\n\n  data() {\n    return {\n      loaded: false,\n\n      filterData: {},\n      clusterData: [],\n      chartData: {},\n\n      tableHeaders: [\n        { text: \"Время\", filterable: true, align: \"start\", value: \"datetime\" },\n        { text: \"Регион\", filterable: true, align: \"start\", value: \"region\" },\n        { text: \"Адрес\", filterable: true, align: \"start\", value: \"address\" },\n        {\n          text: \"Категория\",\n          filterable: true,\n          align: \"start\",\n          value: \"category\",\n        },\n        { text: \"Освещение\", filterable: true, align: \"start\", value: \"light\" },\n      ],\n    };\n  },\n\n  methods: {\n    download(format) {\n      let url = new URL(`${this.$store.state.backendUrl}/file/cluster/${this.filterData.cluster_quontity}/${format}/`);\n      if (this.filterData) {\n        Object.keys(this.filterData).forEach((key) => {\n          if (this.filterData[key]) {\n            try {\n              url.searchParams.set(key, this.filterData[key].toISOString());\n            } catch {\n              url.searchParams.set(key, this.filterData[key]);\n            }\n          }\n        });\n      }\n      window.open(url.href);\n    },\n\n    getData(val) {\n      this.filterData = val;\n\n      axios\n        .get(`${this.$store.state.backendUrl}/map/plot-bar/`, {\n          params: {\n            category: this.filterData.category,\n            region: this.filterData.region,\n            light: this.filterData.light,\n            datetime_before: this.filterData.datetime_before,\n            datetime_after: this.filterData.datetime_after,\n            time_group: this.filterData.time_group,\n          },\n        })\n        .then((response) => {\n          this.chartData = {\n            labels: response.data.map((x) => x.month),\n            datasets: [\n              {\n                label: \"Количество преступлений по датам\",\n                borderColor: \"EDAC48\",\n                pointBackgroundColor: \"black\",\n                borderWidth: 1,\n                pointBorderColor: \"white\",\n                backgroundColor: \"#EDAC48\",\n                data: response.data.map((x) => x.c),\n              },\n            ],\n          };\n        });\n    },\n\n    getTable(val) {\n      this.loaded = false;\n      this.clusterData = val;\n      this.loaded = true;\n    },\n  },\n};\n</script>"]}]}