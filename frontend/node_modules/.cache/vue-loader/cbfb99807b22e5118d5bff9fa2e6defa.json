{"remainingRequest":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/john/Documents/Projects/Хакатоны/mvd/frontend/src/views/Main/Stat.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/src/views/Main/Stat.vue","mtime":1620585171745},{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/john/Documents/Projects/Хакатоны/mvd/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTdGF0RmlsdGVyIGZyb20gIkAvY29tcG9uZW50cy9zdGF0L1N0YXRGaWx0ZXIudnVlIjsKaW1wb3J0IERhdGFUYWJsZUhlYWRlckNsaWNrZXIgZnJvbSAiQC9jb21wb25lbnRzL3N0YXQvRGF0YVRhYmxlSGVhZGVyQ2xpY2tlci52dWUiOwppbXBvcnQgQ2hhcnQgZnJvbSAiQC9jb21wb25lbnRzL0NoYXJ0LnZ1ZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlN0YXQiLAogIGNvbXBvbmVudHM6IHsKICAgIFN0YXRGaWx0ZXIsCiAgICBEYXRhVGFibGVIZWFkZXJDbGlja2VyLAogICAgQ2hhcnQsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGVkOiBmYWxzZSwKICAgICAgY2hhcnREYXRhOiB7fSwKCiAgICAgIHRhYmxlSXRlbXM6IFtdLAoKICAgICAgZmlsdGVyUGFyYW1zOiB7fSwKCiAgICAgIHRpbWVHcm91cHM6IHsKICAgICAgICAi0JLRgdC1INCy0YDQtdC80Y8iOiBudWxsLAogICAgICAgICIyLjAwIC0gMTEuMDAiOiAwLAogICAgICAgICIxMS4wMCAtIDE2LjAwIjogMSwKICAgICAgICAiMTYuMDAgLSAyMS4wMCI6IDIsCiAgICAgICAgIjIxLjAwIC0gMi4wMCI6IDMsCiAgICAgIH0sCgogICAgICB0YWJsZUhlYWRlcnM6IFsKICAgICAgICB7IHRleHQ6ICLQktGA0LXQvNGPIiwgdmFsdWU6ICJkYXRldGltZSIgfSwKICAgICAgICB7IHRleHQ6ICLQk9C+0YDQvtC0IiwgdmFsdWU6ICJwYXJlbnRfcmVnaW9uIiB9LAogICAgICAgIHsgdGV4dDogItCg0LXQs9C40L7QvSIsIHZhbHVlOiAicmVnaW9uIiB9LAogICAgICAgIHsgdGV4dDogItCQ0LTRgNC10YEiLCB2YWx1ZTogImFkZHJlc3MiIH0sCiAgICAgICAgeyB0ZXh0OiAi0KHQv9C+0YHQvtCxINGB0L7QstC10YDRiNC10L3QuNGPINC/0YDQtdGB0YLRg9C/0LvQtdC90LjRjyIsIHZhbHVlOiAiY2F0ZWdvcnkiIH0sCiAgICAgICAgeyB0ZXh0OiAi0J3QsNC40LzQtdC90L7QstCw0L3QuNC1INC+0YDQs9Cw0L3QsCIsIHZhbHVlOiAib3JnYW5pemF0aW9uIiB9LAogICAgICAgIHsgdGV4dDogItCS0LjQtCDRg9Cz0L7Qu9C+0LLQvdC+0LPQviDQv9GA0LXRgdC70LXQtNC+0LLQsNC90LjRjyIsIHZhbHVlOiAiY3JpbWluYWxfdHlwZSIgfSwKICAgICAgICB7IHRleHQ6ICLQmtC10Lwg0LLRi9GP0LLQu9C10L3QviIsIHZhbHVlOiAiZW1wbG95ZWUiIH0sCiAgICAgICAgeyB0ZXh0OiAi0JrQstCw0LvQuNGE0LjQutCw0YbQuNGPINC/0YDQtdGB0YLRg9C/0LvQtdC90LjRjyIsIHZhbHVlOiAiY3JpbWVfcXVhbGlmaWNhdGlvbiIgfSwKICAgICAgICB7IHRleHQ6ICLQmtCy0LDQu9C40YTQuNC60LDRhtC40Y8g0L/QviDQo9CaIiwgdmFsdWU6ICJ5a19xdWFsaWZpY2F0aW9uIiB9LAogICAgICAgIHsgdGV4dDogItCi0Y/QttC10YHRgtGMIiwgdmFsdWU6ICJzZXZlcml0eSIgfSwKICAgICAgICB7IHRleHQ6ICLQndCw0L/RgNCw0LLQu9C10L3QvdC+0YHRgtGMIiwgdmFsdWU6ICJjcmltZV9kaXJlY3Rpb24iIH0sCiAgICAgICAgeyB0ZXh0OiAi0KPRidC10YDQsSIsIHZhbHVlOiAiZGFtYWdlIiB9LAogICAgICAgIHsgdGV4dDogItCU0LXQvdGM0LPQuCIsIHZhbHVlOiAibW9uZXkiIH0sCiAgICAgICAgeyB0ZXh0OiAi0J3QsNC40LzQtdC90L7QstCw0L3QuNC1INC90LDRgNC60L7RgtC40LrQsCIsIHZhbHVlOiAiZHJ1Z19uYW1lIiB9LAogICAgICAgIHsgdGV4dDogItCc0LDRgdGB0LAg0L3QsNGA0LrQvtGC0LjQutC+0LIiLCB2YWx1ZTogImRydWdfd2VpZ2h0IiB9LAogICAgICAgIHsgdGV4dDogItCa0L7Qu9C40YfQtdGB0YLQstC+INC/0L7RgdGC0YDQsNC00LDQstGI0LjRhSIsIHZhbHVlOiAidmljdGltX251bWJlciIgfSwKICAgICAgICB7IHRleHQ6ICLQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C+0LPQuNCx0YjQuNGFIiwgdmFsdWU6ICJkZWFkX251bSIgfSwKICAgICAgICB7IHRleHQ6ICLQkiDQv9GA0L7RhtC10YHRgdC1IiwgdmFsdWU6ICJpc19vcGVyYXRpdmUiIH0sCiAgICAgICAgeyB0ZXh0OiAi0J/RgNC40LPQvtGC0L7QstC70LXQvdC40LUv0L/QvtC60YPRiNC10L3QuNC1IiwgdmFsdWU6ICJpc19hdHRlbXB0IiB9LAogICAgICAgIHsgdGV4dDogItCe0YHQstC10YnQtdC90LjQtSIsIHZhbHVlOiAibGlnaHQiIH0sCiAgICAgIF0sCiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGRvd25sb2FkKGZvcm1hdCkgewogICAgICBsZXQgdXJsID0gbmV3IFVSTChgJHt0aGlzLiRzdG9yZS5zdGF0ZS5iYWNrZW5kVXJsfS9maWxlL2dldC8ke2Zvcm1hdH0vYCk7CiAgICAgIGlmICh0aGlzLmZpbHRlclBhcmFtcykgewogICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmlsdGVyUGFyYW1zKS5mb3JFYWNoKChrZXkpID0+IHsKICAgICAgICAgIGlmICh0aGlzLmZpbHRlclBhcmFtc1trZXldKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoa2V5LCB0aGlzLmZpbHRlclBhcmFtc1trZXldLnRvSVNPU3RyaW5nKCkpOwogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChrZXksIHRoaXMuZmlsdGVyUGFyYW1zW2tleV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgd2luZG93Lm9wZW4odXJsLmhyZWYpOwogICAgfSwKCiAgICBnZXREYXRhKGZpbHRlclBhcmFtcykgewogICAgICB0aGlzLmZpbHRlclBhcmFtcyA9IGZpbHRlclBhcmFtczsKICAgICAgY29uc29sZS5sb2coZmlsdGVyUGFyYW1zKQogICAgICBheGlvcwogICAgICAgIC5nZXQoYCR7dGhpcy4kc3RvcmUuc3RhdGUuYmFja2VuZFVybH0vbWFwL2RldGFpbC9gLCB7CiAgICAgICAgICBwYXJhbXM6IGZpbHRlclBhcmFtcwogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKHIpID0+IHsKICAgICAgICAgIHRoaXMudGFibGVJdGVtcyA9IHIuZGF0YTsKICAgICAgICB9KTsKICAgIH0sCgogICAgYXN5bmMgZ2V0Q2hhcnQoY29sdW1uKSB7CiAgICAgIHRoaXMuZmlsdGVyUGFyYW1zLnRpbWVfZ3JvdXAgPSB0aGlzLnRpbWVHcm91cHNbdGhpcy5maWx0ZXJQYXJhbXMudGltZV9ncm91cF07CgogICAgICBpZiAoY29sdW1uICE9IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7CiAgICAgICAgYXdhaXQgYXhpb3MKICAgICAgICAgIC5nZXQoYCR7dGhpcy4kc3RvcmUuc3RhdGUuYmFja2VuZFVybH0vbWFwL3Bsb3QtZGlhZ3JhbS8ke2NvbHVtbn0vYCwgewogICAgICAgICAgICBwYXJhbXM6IHRoaXMuZmlsdGVyUGFyYW1zLAogICAgICAgICAgfSkKICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgICBsZXQgbmFtZSA9ICIiOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGFibGVIZWFkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMudGFibGVIZWFkZXJzW2ldLnZhbHVlID09IGNvbHVtbikgewogICAgICAgICAgICAgICAgbmFtZSA9IHRoaXMudGFibGVIZWFkZXJzW2ldLnRleHQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLmNoYXJ0RGF0YSA9IHsKICAgICAgICAgICAgICBsYWJlbHM6IHJlc3BvbnNlLmRhdGEubWFwKCh4KSA9PiB4LmZpZWxkKSwKICAgICAgICAgICAgICBkYXRhc2V0czogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBsYWJlbDogYNCa0L7Qu9C40YfQtdGB0YLQstC+INC/0YDQtdGB0YLRg9C/0LvQtdC90LjQuSDQv9C+ICR7bmFtZX1gLAogICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogIiNFREFDNDgiLAogICAgICAgICAgICAgICAgICBwb2ludEJhY2tncm91bmRDb2xvcjogIiNFREFDNDgiLAogICAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogMSwKICAgICAgICAgICAgICAgICAgcG9pbnRCb3JkZXJDb2xvcjogIndoaXRlIiwKICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAiI0VEQUM0OCIsCiAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLmRhdGEubWFwKCh4KSA9PiB4LmMpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBdLAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Stat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Stat.vue","sourceRoot":"src/views/Main","sourcesContent":["<template>\n  <div>\n    <StatFilter class=\"map-filter\" v-on:get-data=\"getData\" />\n    <DataTableHeaderClicker\n      :tableHeaders=\"tableHeaders\"\n      :tableItems=\"tableItems\"\n      v-on:get-chart=\"getChart\"\n      v-on:download=\"download\"\n    />\n    <v-card\n      class=\"chart-card\"\n      style=\"border-radius: 15px; max-height: 500px; margin-bottom: 60px\"\n      v-if=\"loaded\"\n      elevation=\"0\"\n    >\n      <Chart :chart-data=\"chartData\" />\n    </v-card>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import \"@/styles/common.scss\";\n@import \"@/styles/views/stat.scss\";\n</style>\n\n<script>\nimport StatFilter from \"@/components/stat/StatFilter.vue\";\nimport DataTableHeaderClicker from \"@/components/stat/DataTableHeaderClicker.vue\";\nimport Chart from \"@/components/Chart.vue\";\n\nexport default {\n  name: \"Stat\",\n  components: {\n    StatFilter,\n    DataTableHeaderClicker,\n    Chart,\n  },\n  data() {\n    return {\n      loaded: false,\n      chartData: {},\n\n      tableItems: [],\n\n      filterParams: {},\n\n      timeGroups: {\n        \"Все время\": null,\n        \"2.00 - 11.00\": 0,\n        \"11.00 - 16.00\": 1,\n        \"16.00 - 21.00\": 2,\n        \"21.00 - 2.00\": 3,\n      },\n\n      tableHeaders: [\n        { text: \"Время\", value: \"datetime\" },\n        { text: \"Город\", value: \"parent_region\" },\n        { text: \"Регион\", value: \"region\" },\n        { text: \"Адрес\", value: \"address\" },\n        { text: \"Способ совершения преступления\", value: \"category\" },\n        { text: \"Наименование органа\", value: \"organization\" },\n        { text: \"Вид уголовного преследования\", value: \"criminal_type\" },\n        { text: \"Кем выявлено\", value: \"employee\" },\n        { text: \"Квалификация преступления\", value: \"crime_qualification\" },\n        { text: \"Квалификация по УК\", value: \"yk_qualification\" },\n        { text: \"Тяжесть\", value: \"severity\" },\n        { text: \"Направленность\", value: \"crime_direction\" },\n        { text: \"Ущерб\", value: \"damage\" },\n        { text: \"Деньги\", value: \"money\" },\n        { text: \"Наименование наркотика\", value: \"drug_name\" },\n        { text: \"Масса наркотиков\", value: \"drug_weight\" },\n        { text: \"Количество пострадавших\", value: \"victim_number\" },\n        { text: \"Количество погибших\", value: \"dead_num\" },\n        { text: \"В процессе\", value: \"is_operative\" },\n        { text: \"Приготовление/покушение\", value: \"is_attempt\" },\n        { text: \"Освещение\", value: \"light\" },\n      ],\n    };\n  },\n\n  methods: {\n    download(format) {\n      let url = new URL(`${this.$store.state.backendUrl}/file/get/${format}/`);\n      if (this.filterParams) {\n        Object.keys(this.filterParams).forEach((key) => {\n          if (this.filterParams[key]) {\n            try {\n              url.searchParams.set(key, this.filterParams[key].toISOString());\n            } catch {\n              url.searchParams.set(key, this.filterParams[key]);\n            }\n          }\n        });\n      }\n      window.open(url.href);\n    },\n\n    getData(filterParams) {\n      this.filterParams = filterParams;\n      console.log(filterParams)\n      axios\n        .get(`${this.$store.state.backendUrl}/map/detail/`, {\n          params: filterParams\n        })\n        .then((r) => {\n          this.tableItems = r.data;\n        });\n    },\n\n    async getChart(column) {\n      this.filterParams.time_group = this.timeGroups[this.filterParams.time_group];\n\n      if (column != undefined) {\n        this.loaded = false;\n        await axios\n          .get(`${this.$store.state.backendUrl}/map/plot-diagram/${column}/`, {\n            params: this.filterParams,\n          })\n          .then((response) => {\n            let name = \"\";\n            for (let i = 0; i < this.tableHeaders.length; i++) {\n              if (this.tableHeaders[i].value == column) {\n                name = this.tableHeaders[i].text;\n              }\n            }\n\n            this.chartData = {\n              labels: response.data.map((x) => x.field),\n              datasets: [\n                {\n                  label: `Количество преступлений по ${name}`,\n                  borderColor: \"#EDAC48\",\n                  pointBackgroundColor: \"#EDAC48\",\n                  borderWidth: 1,\n                  pointBorderColor: \"white\",\n                  backgroundColor: \"#EDAC48\",\n                  data: response.data.map((x) => x.c),\n                },\n              ],\n            };\n\n            this.loaded = true;\n          });\n      }\n    },\n  },\n};\n</script>"]}]}